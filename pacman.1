#include <iostream>
#include<Windows.h> //system("cls");
#include<conio.h> //getch();
#define WID 17
#define HEI 22
#define GWID 10
#define GHEI 15
using namespace std;

int x = 9;
int y = 9;
int gx= 14;
int gy = 2;
int map[HEI][WID] = { {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
                       {1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1},
                       {1,0,1,1,0,1,1,0,1,0,1,1,0,1,1,0,1},
                       {1,0,1,1,0,1,1,0,1,0,1,1,0,1,1,0,1},
                       {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
                       {1,0,1,1,0,1,0,1,1,1,0,1,0,1,1,0,1},
                       {1,0,0,0,0,1,0,0,1,0,0,1,0,0,0,0,1},
                       {1,1,1,1,0,1,1,0,0,0,1,1,0,1,1,1,1},
                       {1,1,1,1,0,1,0,0,0,0,0,1,0,1,1,1,1},
                       {1,1,1,1,0,1,0,1,0,1,0,1,0,1,1,1,1},
                       {0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0},
                       {1,1,1,1,0,1,0,0,0,0,0,1,0,1,1,1,1},
                       {1,1,1,1,0,1,0,0,0,0,0,1,0,1,1,1,1},
                       {1,1,1,1,0,1,0,1,1,1,0,1,0,1,1,1,1},
                       {1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1},
                       {1,0,1,1,0,1,1,0,0,0,1,1,0,1,1,0,1},
                       {1,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,1},
                       {1,1,0,1,0,1,0,1,1,1,0,1,0,1,0,1,1},
                       {1,0,0,0,0,1,0,0,1,0,0,1,0,0,0,0,1},
                       {1,0,1,1,1,1,1,0,0,0,1,1,1,1,1,0,1},
                       {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
                       {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1} };
int way = 0;        // 1 위 2 뒤 3 오른 4 왼

int flag = 0;
int colorflag=0;
enum colorName
{
BLACK,
D_BLUE,
D_GREEN,
D_SKYBLUE,
D_RED,
D_VIOLET,
D_YELLOW,
GRAY,
D_GRAY,
BLUE,
GREEN,
SKYBLUE,
RED,
VIOLET,
YELLOW,
WHITE,
};
void CursorView(char show)//커서숨기기
{
    HANDLE hConsole;
    CONSOLE_CURSOR_INFO ConsoleCursor;

    hConsole = GetStdHandle(STD_OUTPUT_HANDLE);

    ConsoleCursor.bVisible = show;
    ConsoleCursor.dwSize = 1;

    SetConsoleCursorInfo(hConsole, &ConsoleCursor);
}

void goToPoint(int x, int y) {
    COORD Cur;
    Cur.X = x;
    Cur.Y = y;

    SetConsoleCursorPosition(GetStdHandle(STD_OUTPUT_HANDLE), Cur);

}
void drw(int bgColor,int textColor) {
    goToPoint(x, y);
    if(colorflag == 0) {
        SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), bgColor * 16 + textColor);
        printf("\b0");

        SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), bgColor * 16 + textColor);
        //colorflag =1;
    }
    /*
    else {
        SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), 6);
        printf("\b+");

        SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), 7);
        colorflag = 0;
    }   */
}


void mov(int key) {
    if (key == 83 || key == 115) {
        //flag = 1;
        //while (1) {
           // if (flag == 0) break;
        if (map[y + 1][x-1] != 0) {
            return;
        }
        else if (y + 1 < HEI && y + 1 >= 0) {
            y++;
            drw(BLACK,BLACK);
            goToPoint(x, y - 1);
            printf("\b ");
            goToPoint(x, y);
            Sleep(100);
        }
           // else flag = 0;
       // }
    }
    else if (key == 87 || key == 119) {
        //flag = 1;
        //while (1) {
            //if (flag == 0) break;
        if (map[y - 1][x-1] != 0) {
            return;
        }
        else if (y - 1 < HEI && y - 1 >= 0) {

            y--;
            drw(RED,RED);
            goToPoint(x, y + 1);
            printf("\b ");
            goToPoint(x, y);
            Sleep(100);
        }
           // else flag = 0;
        //}
    }
    if (key == 68 || key == 100) {
       // flag = 1;
        //while (1) {
            //if (flag == 0) break;
        if (map[y][x] != 0) {
            return;
        }
        else if (x + 1 <= WID && x + 1 > 0) {
            x++;
            drw(BLACK,BLACK);
            goToPoint(x - 1, y);
            printf("\b ");
            goToPoint(x, y);
            Sleep(100);
        }
            //else flag = 0;
        //}
    }
    if (key == 65 || key == 97) {
        //flag = 1;
        //while (1) {
            //if (flag == 0) break;
        if (map[y][x-2] != 0) {
            return;
        }
        else if (x - 1 <= WID && x - 1 > 0) {
            x--;
            drw(BLACK,BLACK);
            goToPoint(x + 1, y);
            printf("\b ");
            goToPoint(x, y);
            Sleep(100);
        }
          //  else flag = 0;
        //}
    }


}

int main() {
    int i, j;

    for (i = 0; i < HEI; i++) {
        for (j = 0; j < WID; j++) {
            if(map[i][j] == 1) {
                SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), bgColor * 16 + textColor);
                printf("1" );
                  (GetStdHandle(STD_OUTPUT_HANDLE), bgColor * 16 + textColor);
            }
            else {
                printf(" ");
            }

        }
        printf("\n");
    }
    CursorView(0);
    drw(RED,RED);
    while (1) {
        mov(_getch());
    }
    
    return 0;
}
